<!DOCTYPE html PUBLIC>
<html>
<head>
<title>Fixed Priority Algorithm</title>
<script type = "text/javascript">
	<!--
	function randomGen(high, low) {		//random number generator called by several functions.
		rand = Math.floor((Math.random() * high) + low);
		return rand;
	};
	
	function bound() {		//finds the %processor utilization the tasks must be under for the set to be feasible
		
		temp = 1 / m;
		temp = Math.pow(2, temp);
		UtiBound = m * (temp - 1);
		UtiBound = UtiBound * 100;
		
	};
	
	function Utilize() {		//finds the processor utilization for the task set
		for (i = 0; i < m; i++) {
			temp = runTimes[i] / requestTimes[i];
			ute = temp + ute;
		};
	};
	
	function getInfoWeight() {		//creates a task set that's more likely to have a solution than a "fair" randomly generated set
		for (i = 0; i < m; i++) {
			requestTimes[i] = randomGen((m * 10), 15);
			temp = requestTimes[i] / (m - 2);
			runTimes[i] = randomGen(temp, 1);
			if (runTimes[i] >= requestTimes[i] || (runTimes[i] / requestTimes[i]) >= m / (m * 2)) {
				i--;
			};
		};
	};
	
	function getInfo() {		//gets a semi-random set of tasks
		for (i = 0; i < m; i++) {
			requestTimes[i] = randomGen(50, 20);
			runTimes[i] = randomGen(35, 1);
			if (runTimes[i] >= requestTimes[i] || (runTimes[i] / requestTimes[i]) >= m / (m * 2)) {
				i--;
			};
		};
	};
	
	function sorter() {		//special sorting function that sorts the request times and keeps the runTimes in order
		for (i = 0; i < m; i++) {
			if (requestTimes[i] > requestTimes[i + 1]) {
				holder = requestTimes[i];
				requestTimes[i] = requestTimes[i + 1];
				requestTimes[i + 1] = holder;
				holder = runTimes[i];
				runTimes[i] = runTimes[i + 1];
				runTimes[i + 1] = holder;
			};
		};
	};
	
	function grapher() {
		graphs = [[], []];
		y = 0;
		completed = [];
		
		for (i = 0; i < m; i++) {		//making 0 the first element of the completed array
			completed[i] = 0;
		};
		
		for (i = 0; i <= m; i++) {	//making a 2D array with 2nd D's size m
			graphs[i] = [];
		};
		
		for (i = 0; i < m; i++) {
			for (j = 0; j < 200; j++) {
				graphs[i][j] = 0;
			};
		};
		
		for (x = 0; x < m; x++) {
			for (i = 0; i < 200;) {
				graphs[x][i] = 2;
				i = (i + requestTimes[x]) - 1;
			};
		};
		
		for (i = 0; i < 200; i++) {
			graphs[m][i] = i;
		};
		
		j = 0;
		k = 0;
		for (i = 0; i < 500; i++) {
			for (x = 0; x < m; x++) {
				if (graphs[x][j] == 2) {
					completed[x] = 0;
					
				};
			};

			if (completed[k] < runTimes[k]) {
				graphs[k][j + 1] = 1;
				j++;
				completed[k] = completed[k] + 1;
				k = 0;
			} else if (graphs[k][j] == 2) {
				completed[k] = 0;
				k = 0;
				for (b = 0; b < m; b++) {
					graphs[b][j] = 3;
				};
			} else if (k < m - 1) {
				k++;
			} else {
				k = 0;
				j++;
			};
		};

		printIt();
	
	};
	
	function printIt() {
		document.writeln("<table border = 1 style = border-collapse: collapse;>");
		
		for (i = 0; i < m; i++) {
			document.writeln("<tr>");
			for (j = 0; j < 200; j++) {
				if (graphs[i][j] == 0) {
					document.writeln("<td style = 'background-color: white; color: white;'>...</td>");
				} else if (graphs[i][j] == 2) {
					document.writeln("<td style = 'background-color: black;'>..</td>");
				} else {
					document.writeln("<td style = 'background-color: green; color: green;'>...</td>");
				};
			};
			document.writeln("</tr>");
		};
		document.writeln("<tr>");
		for (k = 0; k < 200; k++) {
			document.writeln("<td>" +graphs[m][k]+ "</td>");
		};
		document.writeln("</table>");
		
	};
	
	var runTimes = [9, 3, 6], requestTimes = [26, 11, 31], temp = 0, ute = 0, high = 50, low = 1, weight = 0;
	
	//weight = window.prompt("Weighted? Y/N:");
	m = 3;
	
	sorter();
	
	bound();
	
	/*if (weight == "Y" || weight == "y") {
		getInfoWeight();
	} else {
		getInfo();
	};*/
	
	Utilize();
	
	document.writeln("<table border = 1><tr><td>Request Periods (Ti)</td><td>Run Times (Ci)</td></tr>");
	for (i = 0; i < m; i++) {
		document.writeln("<tr><td>" +requestTimes[i]+ "</td><td>" +runTimes[i]+ "</td></tr>");
	};
	document.writeln("</table>");
	
	document.writeln("Bound: " +Math.round(UtiBound)+ "% Utilization: " +Math.round(ute * 100)+ "%");
	
	ute = Math.round(ute * 100)
	if (ute <= UtiBound) {
		document.writeln("<br />The algorithm is <p style = 'color: green;'> feasible</p>");
	} else if (ute <= '100') {
		document.writeln("<br />It is <i>unclear</i> if the algorithm is feasible");
	} else {
		document.writeln("<br />The algorithm is <p style = 'color: red;'> <i>not</i> feasible</p>");
	};
		
	grapher();
		
	//-->
</script>
</head>

<body>

</body>

</html>
